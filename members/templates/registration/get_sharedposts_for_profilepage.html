{% extends 'basetwo.html' %}
{% load static %}
{% block title %}Profile{% endblock %}
{% block content %}

<div class="fh5co-parallax largerbanner" style="background-image: url(/static/images/fitnesspic2.jpg);">
    {% comment %} <div class="container">    {% endcomment %}
        {% comment %} <div class="row"> {% endcomment %}
			{% comment %} <div class="col-md-8 col-md-offset-2 col-sm-12 col-sm-offset-0 col-xs-12 col-xs-offset-0 text-center fh5co-table"> {% endcomment %}
            {% comment %} <div class="fh5co-intro fh5co-table-cell animate-box"> {% endcomment %}
    <section class="content-item" id="comments">
        <div class="container">   
        <div class="col-sm-8 col-md-offset-2">   
          <h1 class="row justify-content-center">{% if request.user is not profile.user %}{{ profile.user.username }} Shared Posts {% else %} Your Shared Posts{% endif %}</h1>

            {% comment %} <h3 class="row justify-content-center">Post count: {{ post_count }}</h3> {% endcomment %}
            {% comment %} <h3>4 Comments</h3> {% endcomment %}
            
            <!-- COMMENT 1 - START -->
            {% for sharedpost in sharedposts %}
                {% if sharedpost.shared_user %}
                    
                    <div class="media">
                        <a class="pull-left" href="{% url 'show_profile_page' sharedpost.shared_user.profile.pk %}"> 
                            <img src="{{ sharedpost.shared_user.profile.picture.url }}" alt="" class="shared-image">
                            {% comment %} <small class="postauthor">{{ post.shared_user }}</small> {% endcomment %}
                        </a>
                        {% comment %} <a class="pull-left" href="#"><img class="media-object" src="https://bootdey.com/img/Content/avatar/avatar1.png" alt=""></a> {% endcomment %}
                        <div class="media-body">
                            {% comment %} {% if post.body %} {% endcomment %}
                            <h4 class="media-heading">{{ sharedpost.shared_user }} shared a post <i class="fa fa-calendar"></i> {{post.created_on}}
                                {% if request.user == sharedpost.shared_user %}
                                {% comment %} <a href="{% url 'post-edit' post.pk %}" style="color: green !important;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                                <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                                <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
                                </svg></a> {% endcomment %}

                                <a href="{% url 'post-delete' sharedpost.pk %}" class="red"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
                                <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"/>
                                </svg></a>{% endif %}
                            </h4>
                            <p class="white">{{ sharedpost.shared_body }}</p>
                            {% comment %} <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p> {% endcomment %}
                            <ul class="list-unstyled list-inline media-detail pull-left">
                                {% comment %} <li><i class="fa fa-calendar"></i>{{post.created_on}}</li> {% endcomment %}
                                {% comment %} <li class=""><a href="{% url 'post-detail' post.pk %}" class="">View Comments</a></li> {% endcomment %}
                                <li class=""><button class="remove-default-btn reply-button pull-left"><a href="{% url 'post-detail' sharedpost.pk %}" class="">View Comments</a></button></li>


                                {% comment %} <li><i class="fa fa-thumbs-up"></i>13</li> {% endcomment %}
                            </ul>
                            
                            <ul class="list-unstyled list-inline media-detail pull-right">
                                <li class="">
                                    <form method="POST" action="{% url 'like' sharedpost.id %}" class="like-form" id="{{sharedpost.id}}">
                                        {% csrf_token %}
                                        {% if user not in sharedpost.likes.all %}
                                            <input type="hidden"  name="post_id" value="{{ sharedpost.id }}">
                                            <button class=" thumbs-btn like-btn{{sharedpost.id}}" type="submit">
                                                <i class="fa fa-thumbs-up thumbs like-icon{{sharedpost.id}}" ><span class="like_count{{sharedpost.id}}">{{ sharedpost.likes.all.count }}</span></i>
                                            </button>
                                        {% else %}
                                            <input type="hidden" name="post_id" value="{{ sharedpost.id }}">
                                            <button class=" thumbs-btn thumbs-fillgreen like-btn{{sharedpost.id}}" type="submit">
                                                <i class="fa fa-thumbs-up thumbs like-icon{{sharedpost.id}}"><span class="like_count{{sharedpost.id}}">{{ sharedpost.likes.all.count }}</span></i>
                                            </button>
                                        {% endif %}
                                    </form>
                                </li>
                                <li class="">
                                    <form method="POST" action="{% url 'dislike' sharedpost.id %}" class="dislike-form thumb-buttons" id='{{sharedpost.id}}'>
                                        {% csrf_token %}
                                        {% if user not in sharedpost.dislikes.all %}
                                            <input type="hidden" name="post_id" value="{{ sharedpost.id }}">
                                            <button class="thumbs-btn dislike-btn{{sharedpost.id}}" type="submit" >
                                                <i class="fa fa-thumbs-down thumbs dislike-icon{{sharedpost.id}}" > <span class="dislike_count{{sharedpost.id}}">{{ sharedpost.dislikes.all.count }}</span></i>
                                            </button>
                                        {% else %}
                                            <input type="hidden" name="post_id" value="{{ sharedpost.id }}">
                                            <button class=" thumbs-btn thumbs-fillred dislike-btn{{sharedpost.id}}" type="submit" >
                                                <i class="fa fa-thumbs-down thumbs dislike-icon{{sharedpost.id}}" > <span class="dislike_count{{sharedpost.id}}">{{ sharedpost.dislikes.all.count }}</span></i>
                                            </button>
                                        {% endif %}
                                    </form>
                                </li>
                            </ul>
                            
                        {% comment %} {% endif %} {% endcomment %}
                        </div>
                    </div>
                    <div class="media sharedpost " style="border-top: none !important;">
                        <a href="{% url 'show_profile_page' sharedpost.author.profile.pk %}"> 
                            <img src="{{ sharedpost.author.profile.picture.url }}" alt="" class="shared-image" style="margin: 8px;">
                        </a>
                        <div class="media-body sharedpostbody">
                            {% comment %} {% if post.body %} {% endcomment %}
                            
                            <h4 class="media-heading">{{ sharedpost.author }}</h4>
                            <p class="white">{{ sharedpost.body }}</p>
                            {% if post.image %}
                                <div class="ajax_image" style="">
                                    <img src="{{ sharedpost.image.url }}" class="post-image"/>
                                </div>
                            {% endif %}
                            {% if post.video %}
                                <video class="embed-responsive embed-responsive-16by9" controls="controls" class="post-image">
                                    <source src="{{sharedpost.video.url}}" type="video/mp4" />
                                </video>
                            {% endif %}
                            {% comment %} <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p> {% endcomment %}
                            <ul class="list-unstyled list-inline media-detail pull-left">
                                <li><i class="fa fa-calendar"></i>{{sharedpost.shared_on}}</li>
                                {% comment %} <li><i class="fa fa-thumbs-up"></i>13</li> {% endcomment %}
                            </ul>
                            <ul class="list-unstyled list-inline media-detail pull-right">
                            </ul>
                            {% comment %} {% endif %} {% endcomment %}
                        </div>
                    </div>
                
                {% endif %}
            {% endfor %}
            
        </div>
        </div>
        <div class="row justify-content-center mt-3 page ">
            <div class="col-md-5 col-sm-12 position-relative">
                <p style="color: white !important">Page {{ posts.number }} of {{ posts.paginator.num_pages }}</p>
                
                {% if posts.has_previous %}
                <div class="d-flex flex-row">
                <p><a href="?page=1">&laquo First</a></p>&nbsp;&nbsp;&nbsp;&nbsp;
                <p><a href="?page={{ posts.previous_page_number }}">Previous</a></p>
                </div>
                {% endif %}
    
                {% if posts.has_next %}
                <div class="d-flex flex-row">
                <p><a href="?page={{ posts.next_page_number }}">Next</a></p> &nbsp;&nbsp;&nbsp;&nbsp;
                <p><a href="?page={{ posts.paginator.num_pages }}">Last &raquo</a></p>
                {% endif %}
                </div>
            </div>
        </div>
        
    </section>
            
            {% comment %} </div> {% endcomment %}
            {% comment %} </div> {% endcomment %}
        {% comment %} </div> {% endcomment %}
    {% comment %} </div> {% endcomment %}
</div>
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>
<script src="/static/js/jquery.hashtags.js"></script>
<script src="/static/js/jquery.autosize.js"></script>
{% comment %} <script src="js/jquery.hashtags.js"></script> {% endcomment %}
<script>
    $(document).ready(function() {
        $("form").hashtags();
    });
</script>

<script>
    function myFunction() {
      var x = document.getElementById("myDIV");
      if (x.classList.contains('d-none')) {
        x.classList.remove('d-none');
      } else {
        x.classList.add('d-none')
      }
    }
</script>

<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

<script type="text/javascript">
    $(document).ready(function(){
         
        $('.like-form').submit(function(e){
            e.preventDefault();
            const post_id=$(this).attr('id')
            const likeText = $(`.like-btn${post_id}`).text()
            const trim = $.trim(likeText)
            const url=$(this).attr('action') 
            let res;
            const like = $(`.like_count${post_id}`).text()
            $.ajax({
                method:"POST",
                url:url,
                data:{
                    'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val(),
                    'post_id':post_id,
                },
                success:function(response){
                    if(response.liked===true){
                        $(`.like-icon${post_id}`).addClass('thumbs-fillgreen')
                    }else{
                        $(`.like-icon${post_id}`).removeClass('thumbs-fillgreen')
                    }
                    if(response.liked===true){
                        $(`.like-btn${post_id}`).addClass('thumbs-fillgreen')
                    }else{
                        $(`.like-btn${post_id}`).removeClass('thumbs-fillgreen')
                    }
                    if(response.disliked===true){
                        $(`.dislike-icon${post_id}`).addClass("thumbs-fillred")
                    }else{
                        $(`.dislike-icon${post_id}`).removeClass("thumbs-fillred")
                    }
                    if(response.disliked===true){
                        $(`.dislike-btn${post_id}`).addClass("thumbs-fillred")
                    }else{
                        $(`.dislike-btn${post_id}`).removeClass("thumbs-fillred")
                    }
                    likes=$(`.like_count${post_id}`).text(response.likes_count)
                    parseInt(likes)
                    dislikes=$(`.dislike_count${post_id}`).text(response.dislikes_count)
                    parseInt(dislikes)
                },
                error:function(response){
                    console.log("Failed ", response)
                }
            })
        });


        $('.dislike-form').submit(function(e){
            e.preventDefault();  
            const post_id = $(this).attr('id')
            const dislikeText = $(`.dislike-btn${post_id}`).text()
            const trim = $.trim(dislikeText)
            const url =$(this).attr('action') 
            let res;
            const dislike = $(`.dislike_count${post_id}`).text()
            
            $.ajax({
                method:"POST",
                url:url,
                data:{
                    'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val(),
                    'post_id':post_id,
                },
                success:function(response){
                    if(response.disliked===true){
                      $(`.dislike-icon${post_id}`).addClass("thumbs-fillred")
                    }else{
                      $(`.dislike-icon${post_id}`).removeClass("thumbs-fillred")
                    }
                    if(response.disliked===true){
                        $(`.dislike-btn${post_id}`).addClass("thumbs-fillred")
                      }else{
                        $(`.dislike-btn${post_id}`).removeClass("thumbs-fillred")
                    }
                    if(response.liked===true){
                      $(`.like-icon${post_id}`).addClass('thumbs-fillgreen')
                    }else{
                      $(`.like-icon${post_id}`).removeClass('thumbs-fillgreen')
                    }
                    if(response.liked===true){
                        $(`.like-btn${post_id}`).addClass('thumbs-fillgreen')
                      }else{
                        $(`.like-btn${post_id}`).removeClass('thumbs-fillgreen')
                    }
                    likes=$(`.like_count${post_id}`).text(response.likes_count)
                    parseInt(likes)
                    dislikes=$(`.dislike_count${post_id}`).text(response.dislikes_count)
                    parseInt(dislikes)
                },
                error:function(response){
                    console.log('failed', response)
                }
            }) 
        });

    });
</script>

    

{% endblock %}








 <div class="row mt-5">
    <div class="col-md-3 col-sm-6">
      <a href="{% url 'post-list' %}" class="btn btn-light">Social Feed</a>
    </div>
  </div>
  <div class="row justify-content-center mt-5">
    <div class="col-md-8 col-sm-12 border px-5 pt-3">
      <div class="text-center">
        <h1 class="row justify-content-center mt-3">User Profile</h1> 
        <h5>{{ profile }}</h5>  
        <h6>
          <a href="{% url 'list-followers' profile.pk %}" class="post-link">Followers: {{ number_of_followers }}</a>&nbsp;&nbsp; 
          {% if request.user == user %}
            <a href="{% url 'edit_profile_page' request.user.profile.pk %}">Edit Profile Page</a> &nbsp;&nbsp; 
            <a href="{% url 'edit_profile' request.user.profile.pk %}">Edit User Settings</a>
            <p>Date Joined: {{ user.date_joined }}</p>
          {% endif %}
        </h6>
      </div>
      <div class="text-center">
        {% if profile.picture %}
          <img src="{{ profile.picture.url }}" class="rounded-circle" width="100" height="100">
        {% else %}
          <img src="{% static 'operationfreedom/images/profile_pictures/default_pic.jpg' %}" class="rounded-circle" width="100" height="100">
        {% endif %}
      </div>
      <div class="card-body">
        <div class="text-center">
          <h5 class="card-title">{% if profile.first_name %}{{ profile.first_name }}{% endif %} {% if profile.last_name %}{{ profile.last_name }}{% endif %} </h5>
          <p class="small text-muted">
            {% if profile.website_url %}
              <a target="_blank" href="{{ profile.website_url }}">Website</a>  
            {% endif %}
            {% if profile.facebook_url %}
              | <a target="_blank" href="{{ profile.facebook_url }}">Facebook</a> 
            {% endif %}
            {% if profile.twitter_url %} 
              | <a target="_blank" href="{{ profile.twitter_url }}">Twitter</a> 
            {% endif %}
            {% if profile.instagram_url %} 
              | <a target="_blank" href="{{ profile.instagram_url }}">Instagram</a> 
            {% endif %}
            {% if profile.pinterest_url %} 
              | <a target="_blank" href="{{ profile.pinterest_url }}">Pinterest</a> 
            {% endif %}
            <br>
            {% if profile.location %}
            <p>Location: {{ profile.location }}</p>
            {% endif %}
            {% if profile.birth_date %}
              <p>Birthday: {{ profile.birth_date }}</p>
            {% endif %}
            {% if user == request.user %}
            {% else %}
              {% if is_following %}
                <form method="POST" action="{% url 'remove-follower' profile.pk %}">
                  {% csrf_token %}
                  <button class="btn btn-outline-danger" type="submit">Unfollow</button>
                </form>
              {% else %}
                <form method="POST" action="{% url 'add-follower' profile.pk %}">
                  {% csrf_token %}
                  <button class="btn btn-outline-success" type="submit">Follow</button>
                </form>
              {% endif %}
            {% endif %}
          </p>  
          <p class="card-text">{{ profile.bio }}</p>
        </div>
      </div>
    </div>
  </div>
  <div class="row justify-content-center mt-3 mb-5"><div class="col-md-5 col-sm-12"><div class="flexbox-item-99"><div class="header-info2">
    <h2>{{ user.username }} Shared Posts</h2>
    <h4><a href="{% url 'show_profile_page' user.profile.pk %}">{{ user.username }} Posts</a></h4>
    <h5>Click on a Post to View Comments!</h5>
  </div></div></div></div>
  {% for sharedpost in sharedposts %}
  <div class="row justify-content-center mt-3">
    <div class="col-md-5 col-sm-12 border-bottom position-relative">
    {% if sharedpost.shared_user %}
      <div>
        <a href="{% url 'show_profile_page' sharedpost.shared_user.profile.pk %}">
          <img class="round-circle post-img" height="45" width="45" src="{{ sharedpost.shared_user.profile.picture.url }}" />
        </a>
        <p class="post-text">   
          <a class="text-primary post-link" href="{% url 'show_profile_page' sharedpost.shared_user.profile.pk %}">@{{ sharedpost.shared_user }}</a> shared a post on {{ sharedpost.created_on }}
        </p>
      </div>
    {% endif %}
    {% if sharedpost.shared_body %}
      <div class="position-relative mb-3 body">
        <p>{{ sharedpost.shared_body }}</p>
        <a href="{% url 'post-detail' sharedpost.pk %}" class="stretched-link"></a>
      </div>
      <div class="shared-post">
        <a href="{% url 'show_profile_page' sharedpost.author.profile.pk %}">
          <img class="round-circle post-img" height="45" width="45" src="{{ sharedpost.author.profile.picture.url }}" />
        </a>
        <p class="post-text">
          <a class="text-primary post-link" href="{% url 'show_profile_page' sharedpost.author.profile.pk %}">@{{ sharedpost.author }}</a> {{ sharedpost.shared_on }}
        </p>
      </div>
    {% endif %}
    <div class="shared-post position-relative pt-3">
      <div class="position-relative">
        <div class="body">
          <p>{{ sharedpost.body }}</p>
        </div>
        {% if sharedpost.image %}
          <img src="{{ sharedpost.image.url }}" class="post-image"/>
        {% endif %}
        <a href="{% url 'post-detail' sharedpost.pk %}" class="stretched-link"></a>
      </div>
    </div>
    <div class="d-flex flex-row">
      <form method="POST" action="{% url 'shared-profile-like' profile.pk sharedpost.id   %}" class="like-form" id="{{sharedpost.id}}">
        {% csrf_token %}
        {% if request.user not in sharedpost.likes.all %}
          <input type="hidden"  name="post_id" value="{{ sharedpost.id }}">
          <button class="remove-default-btn like-btn{{sharedpost.id}}" type="submit">
              <i class="far fa-thumbs-up like-icon{{sharedpost.id}}"  ><span class="like_count{{sharedpost.id}}">{{ sharedpost.likes.all.count }}</span></i>
          </button>
        {% else %}
          <input type="hidden" name="post_id" value="{{ sharedpost.id }}">
          <button class="remove-default-btn like-btn{{sharedpost.id}}" type="submit">
              <i class="far fa-thumbs-up like-icon{{sharedpost.id}} btn-success"  ><span class="like_count{{sharedpost.id}}">{{ sharedpost.likes.all.count }}</span></i>
          </button>
        {% endif %}
      </form>
      <form method="POST" action="{% url 'shared-profile-dislike' profile.pk sharedpost.id  %}" class="dislike-form" id='{{sharedpost.id}}'>
        {% csrf_token %}
        {% if request.user not in sharedpost.dislikes.all %}
          <input type="hidden" name="post_id" value="{{ sharedpost.id }}">
          <button class="remove-default-btn dislike-btn{{sharedpost.id}}" type="submit" >
              <i class="far fa-thumbs-down dislike-icon{{sharedpost.id}}"  > <span class="dislike_count{{sharedpost.id}}">{{ sharedpost.dislikes.all.count }}</span></i>
          </button>
        {% else %}
          <input type="hidden" name="post_id" value="{{ sharedpost.id }}">
          <button class="remove-default-btn dislike-btn{{sharedpost.id}}" type="submit" >
              <i class="far fa-thumbs-down dislike-icon{{sharedpost.id}} btn-success"  > <span class="dislike_count{{sharedpost.id}}">{{ sharedpost.dislikes.all.count }}</span></i>
          </button>
        {% endif %}
      </form>
      <p>Comments: {{ comment.count }}</p>
    </div>
    </div>
  </div>
{% endfor %}
<div class="row justify-content-center mt-3">
  <div class="col-md-5 col-sm-12 position-relative">
    {% if sharedposts.has_previous %}
      <a href="?page=1">&laquo First</a>
      <a href="?page={{ sharedposts.previous_page_number }}">Previous</a>
    {% endif %}
    Page {{ sharedposts.number }} of {{ sharedposts.paginator.num_pages }}
    {% if sharedposts.has_next %}
      <a href="?page={{ sharedposts.next_page_number }}">Next</a>
      <a href="?page={{ sharedposts.paginator.num_pages }}">Last &raquo</a>
    {% endif %}
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    $('.like-form').submit(function(e){
      e.preventDefault();
      const post_id=$(this).attr('id')
      const likeText = $(`.like-btn${post_id}`).text()
      const trim = $.trim(likeText)
      const url=$(this).attr('action') 
      let res;
      const like = $(`.like_count${post_id}`).text()
      $.ajax({
        method:"POST",
        url:url,
        data:{
          'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val(),
          'post_id':post_id,
        },
        success:function(response){
          if(response.liked===true){
            $(`.like-icon${post_id}`).addClass('btn-success')
          }else{
            $(`.like-icon${post_id}`).removeClass('btn-success')
          }
          if(response.disliked===true){
            $(`.dislike-icon${post_id}`).addClass("btn-success")
          }else{
            $(`.dislike-icon${post_id}`).removeClass("btn-success")
          }
          likes=$(`.like_count${post_id}`).text(response.likes_count)
          parseInt(likes)
          dislikes=$(`.dislike_count${post_id}`).text(response.dislikes_count)
          parseInt(dislikes)
        },
        error:function(response){
          console.log("Failed ", response)
        }
      })
    });

    $('.dislike-form').submit(function(e){
      e.preventDefault();
      const token=$('input[name=csrfmiddlewaretoken]').val();
      const post_id = $(this).attr('id')
      const dislikeText = $(`.dislike-btn${post_id}`).text()
      const trim = $.trim(dislikeText)
      const url =$(this).attr('action') 
      let res;
      const dislike = $(`.dislike_count${post_id}`).text()
      const trimCount = parseInt(dislike)
      $.ajax({
        method:"POST",
        url:url,
        data:{
          'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val(),
          'post_id':post_id,
        },
        success:function(response){
          if(response.disliked===true){
            $(`.dislike-icon${post_id}`).addClass("btn-success")
          }else{
            $(`.dislike-icon${post_id}`).removeClass("btn-success")
          }
          if(response.liked===true){
            $(`.like-icon${post_id}`).addClass('btn-success')
          }else{
            $(`.like-icon${post_id}`).removeClass('btn-success')
          }
          likes=$(`.like_count${post_id}`).text(response.likes_count)
          parseInt(likes)
          dislikes=$(`.dislike_count${post_id}`).text(response.dislikes_count)
          parseInt(dislikes)
        },
        error:function(response){
          console.log('failed', response)
        }
      }) 
    });

  });
</script>

